/*══════════════════════════════════════════════════════════════════════════════════════════════╗
                                                                                                ║
                    ███████╗ ██████╗ █████╗ ██████╗  █████╗ ██████╗                             ║
                    ██╔════╝██╔════╝██╔══██╗██╔══██╗██╔══██╗██╔══██╗                            ║
                    ███████╗██║     ███████║██████╔╝███████║██████╔╝                            ║
                    ╚════██║██║     ██╔══██║██╔══██╗██╔══██║██╔══██╗                            ║
                    ███████║╚██████╗██║  ██║██║  ██║██║  ██║██████╔╝                            ║
                    ╚══════╝ ╚═════╝╚═╝  ╚═╝╚═╝  ╚═╝╚═╝  ╚═╝╚═════╝                             ║
*═══════════════════════════════════════════════════════════════════════════════════════════════╣           */

#include "quantum.h"
#include "pharaoh.h"

enum _layers { _INSERT, _NAVIGATE, _NUMBERS, _FUNCTION, _MACRO, _MEDIA };

// key aliases
#include "aliases.h"
#include "feature/log/log.h"


/*══════════════════════════════════════════════════════════════════════════════════════════════╣
                         ___  ___  ___  ___  _ _  ___  ___  ___                                 ║
                        | __>| __>| . ||_ _|| | || . \| __>/ __>                                ║
                        | _> | _> |   | | | | ' ||   /| _> \__ \                                ║
                        |_|  |___>|_|_| |_| `___'|_\_\|___><___/                                ║
                                                                                                ║
*═══════════════════════════════════════════════════════════════════════════════════════════════╣           */

#ifdef COMBO_ENABLE
#include "feature/combos/keymap_combo.h"
#endif

#ifdef SWAP_HANDS_ENABLE
#include "feature/swap_hands/swap_hands.h"
#endif

#ifdef OS_DETECTION_ENABLE
#include "feature/os_detect/os_detect.h"
#endif

#ifdef LEADER_ENABLE
#include "feature/leader_key/leader_key.h"
#endif

#ifdef RAW_ENABLE
#include "feature/raw_hid/custom_raw_hid.h"
#endif

#ifdef PROCESS_FEATURES
#include "feature/feature_manager.h"
#endif

#ifdef PROCESS_CUSTOM_MOD_KEYS
#include "feature/mod_keys/mod_keys.h"
#endif

void keyboard_post_init_user(void) {
    log_init();
}


/*══════════════════════════════════════════════════════════════════════════════════════════════╣
                ___  ___  ___  ___  ___  ___  ___   ___  ___  ___  ___  ___  ___                ║
               | . \| . \| . ||  _>| __>/ __>/ __> | . \| __>|  _>| . || . \| . \               ║
               |  _/|   /| | || <__| _> \__ \\__ \ |   /| _> | <__| | ||   /| | |               ║
               |_|  |_\_\`___'`___/|___><___/<___/ |_\_\|___>`___/`___'|_\_\|___/               ║
                                                                                                ║
*═══════════════════════════════════════════════════════════════════════════════════════════════╣           */

bool process_record_user(uint16_t keycode, keyrecord_t* record) {
    // if a key is used by the feature, it returns false to stop processing the key
#ifdef PROCESS_CUSTOM_MOD_KEYS
    if (!process_record_mod_keys(keycode, record)){
        log_key_event(LOG_LEVEL_INFO, "process_record_mod_keys", keycode, record);
        return false;
    }
#endif
#ifdef PROCESS_FEATURES
    if (!process_record_feature(keycode, record)) {
        log_key_event(LOG_LEVEL_INFO, "process_record_feature", keycode, record);
        return false;
    }
#endif
#ifdef RAW_ENABLE
    if (!process_record_raw_hid(keycode, record)) {
        log_key_event(LOG_LEVEL_INFO, "process_record_raw_hid", keycode, record);
        return false;
    }
#endif
#ifdef LEADER_ENABLE
    if (!process_record_leader(keycode, record)) {
        log_key_event(LOG_LEVEL_INFO, "process_record_leader", keycode, record);
        return false;
    }
#endif
#ifdef OS_DETECTION_ENABLE
    if (!process_record_os(keycode, record)) {
        log_key_event(LOG_LEVEL_INFO, "process_record_os", keycode, record);
        return false;
    }
#endif
    return true;
}


/*══════════════════════════════════════════════════════════════════════════════════════════════╣
                             _ __ ___  _ _  __ __  ___  ___  ___                                ║
                            | / /| __>| | ||  \  \| . || . \/ __>                               ║
                            |  \ | _> \   /|     ||   ||  _/\__ \                               ║
                            |_\_\|___> |_| |_|_|_||_|_||_|  <___/                               ║
                                                                                                ║
*═══════════════════════════════════════════════════════════════════════════════════════════════╣           */

const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {

/*══════════════════════════════════════════════════════════════════════════════════════════════╣           */
/*══════════════════════════════| • • • • • • • • - INSERT:0 |══════════════════════════════════╣
                                                                                                ║
        ╔══════╦══════╦══════╦══════╦══════╗       ╔══════╦══════╦══════╦══════╦══════╗         ║
        ║      ║      ║      ║      ║      ║       ║      ║      ║      ║      ║      ║         ║
        ║   :  ║   ,  ║  .   ║  P   ║  Y   ║       ║   F  ║   G  ║   C  ║   R  ║   L  ║         ║
        ╠══════╬══════╬══════╬══════╬══════╣       ╠══════╬══════╬══════╬══════╬══════╣         ║
        ║      ║      ║      ║      ║      ║       ║      ║      ║      ║      ║      ║         ║
        ║   A  ║   O  ║  E   ║  U   ║  I   ║       ║   D  ║   H  ║   T  ║   N  ║   S  ║         ║
        ╠══════╬══════╬══════╬══════╬══════╣       ╠══════╬══════╬══════╬══════╬══════╣         ║
        ║      ║      ║      ║      ║      ║       ║      ║      ║      ║      ║      ║         ║
        ║   "  ║   Q  ║  J   ║  K   ║  X   ║       ║   B  ║   M  ║   W  ║   V  ║   Z  ║         ║
        ╚══════╩══════╩══════╩══════╩══════╝       ╚══════╩══════╩══════╩══════╩══════╝         ║
                               ╔═════╦═════╗       ╔═════╦═════╗                                ║
                               ║     ║LSFT/║       ║NAVGT║NUMBR║                                ║
                               ║MACRO║ TAB ║       ║/SPCE║/LEAD║                                ║
                               ╚═════╩═════╝       ╚═════╩═════╝                                ║
                                                                                                ║        */
    [_INSERT] = LAYOUT(/* INSERT :0 ════════════════════════════════════════════════════════════╣        */
                    CLN_, CM_, DT_, P_,  Y_,        F_, G_, C_, R_, L_,
                    A_,   AO_, GE_, CU_, I_,        D_, H_, T_, N_, S_,
                    DQ_,  Q_,  J_,  K_,  X_,        B_, M_, W_, V_, Z_,

                               MACRO, LS_,          NV_SPC, NUMBR

    ),


/*══════════════════════════════| • • • • • • • - NAVIGATE:1 |══════════════════════════════════╣
                                                                                                ║
        ╔══════╦══════╦══════╦══════╦══════╗       ╔══════╦══════╦══════╦══════╦══════╗         ║
        ║      ║      ║      ║      ║      ║       ║      ║      ║      ║      ║      ║         ║
        ║      ║      ║      ║      ║      ║       ║      ║ BACK ║ PTAB ║ NTAB ║  FWD ║         ║
        ╠══════╬══════╬══════╬══════╬══════╣       ╠══════╬══════╬══════╬══════╬══════╣         ║
        ║      ║      ║      ║      ║      ║       ║      ║      ║      ║      ║      ║         ║
        ║      ║      ║      ║      ║      ║       ║      ║   ←  ║   ↓  ║   ↑  ║    → ║         ║
        ╠══════╬══════╬══════╬══════╬══════╣       ╠══════╬══════╬══════╬══════╬══════╣         ║
        ║      ║      ║      ║      ║      ║       ║      ║      ║      ║      ║      ║         ║
        ║      ║      ║      ║      ║      ║       ║      ║ HOME ║ PTAB ║ NTAB ║  END ║         ║
        ╚══════╩══════╩══════╩══════╩══════╝       ╚══════╩══════╩══════╩══════╩══════╝         ║
                               ╔═════╦═════╗       ╔═════╦═════╗                                ║
                               ║     ║     ║       ║     ║     ║                                ║
                               ║     ║     ║       ║     ║     ║                                ║
                               ╚═════╩═════╝       ╚═════╩═════╝                                ║
                                                                                                ║        */
    [_NAVIGATE] = LAYOUT(/* NAVIGATE :1 ════════════════════════════════════════════════════════╣        */
                    ___, ___, ___, ___, ___,        ___, WBk,   P_TAB, N_TAB, WFwd,
                    ___, ___, ___, ___, ___,        ___, ArL,   ArD,   ArU,   ArR,
                    ___, ___, ___, ___, ___,        ___, HOME,  P_DN,  P_UP,  END,

                                   ___, ___,        FROM, ___

    ),


/*══════════════════════════════| • • • • • • •  - NUMBERS:2 |══════════════════════════════════╣
                                                                                                ║
        ╔══════╦══════╦══════╦══════╦══════╗       ╔══════╦══════╦══════╦══════╦══════╗         ║
        ║      ║      ║      ║      ║      ║       ║      ║      ║      ║      ║      ║         ║
        ║      ║      ║      ║      ║      ║       ║P(VAR)║   7  ║   9  ║   9  ║VAR++ ║         ║
        ╠══════╬══════╬══════╬══════╬══════╣       ╠══════╬══════╬══════╬══════╬══════╣         ║
        ║      ║      ║      ║      ║      ║       ║      ║      ║      ║      ║      ║         ║
        ║      ║      ║      ║      ║      ║       ║   0  ║   4  ║   5  ║   6  ║VAR=1 ║         ║
        ╠══════╬══════╬══════╬══════╬══════╣       ╠══════╬══════╬══════╬══════╬══════╣         ║
        ║      ║      ║      ║      ║      ║       ║      ║      ║      ║      ║      ║         ║
        ║      ║      ║      ║      ║      ║       ║P(VAR)║   1  ║   2  ║   3  ║VAR-- ║         ║
        ╚══════╩══════╩══════╩══════╩══════╝       ╚══════╩══════╩══════╩══════╩══════╝         ║
                               ╔═════╦═════╗       ╔═════╦═════╗                                ║
                               ║     ║     ║       ║     ║     ║                                ║
                               ║TO:FN║     ║       ║     ║ FROM║                                ║
                               ╚═════╩═════╝       ╚═════╩═════╝                                ║
                                                                                                ║        */
    [_NUMBERS] = LAYOUT(/* NUMBERS :2 ══════════════════════════════════════════════════════════╣        */
                ___,  ___,  ___,  ___,  ___,         X_VALU, _7, _8, _9, X_INCR,
                ___,  ___,  ___,  ___,  ___,             _0, _4, _5, _6, X_TARE,
                ___,  ___,  ___,  ___,  ___,         X_VALU, _1, _2, _3, X_DECR,

                                 MO(3), ___,        ___, FROM

    ),


/*══════════════════════════════| • • • • • • • - FUNCTION:3 |══════════════════════════════════╣
                                                                                                ║
        ╔══════╦══════╦══════╦══════╦══════╗       ╔══════╦══════╦══════╦══════╦══════╗         ║
        ║      ║      ║      ║      ║      ║       ║      ║      ║      ║      ║      ║         ║
        ║      ║      ║      ║      ║      ║       ║  F12 ║   F7 ║   F9 ║   F9 ║      ║         ║
        ╠══════╬══════╬══════╬══════╬══════╣       ╠══════╬══════╬══════╬══════╬══════╣         ║
        ║      ║      ║      ║      ║      ║       ║      ║      ║      ║      ║      ║         ║
        ║      ║      ║      ║      ║      ║       ║  F10 ║   F4 ║   F5 ║   F6 ║      ║         ║
        ╠══════╬══════╬══════╬══════╬══════╣       ╠══════╬══════╬══════╬══════╬══════╣         ║
        ║      ║      ║      ║      ║      ║       ║      ║      ║      ║      ║      ║         ║
        ║      ║      ║      ║      ║      ║       ║  F11 ║   F1 ║   F2 ║   F3 ║      ║         ║
        ╚══════╩══════╩══════╩══════╩══════╝       ╚══════╩══════╩══════╩══════╩══════╝         ║
                               ╔═════╦═════╗       ╔═════╦═════╗                                ║
                               ║     ║     ║       ║     ║     ║                                ║
                               ║ FROM║     ║       ║     ║FROM ║                                ║
                               ╚═════╩═════╝       ╚═════╩═════╝                                ║
                                                                                                ║        */
    [_FUNCTION] = LAYOUT(/* FUNCTION :3 ════════════════════════════════════════════════════════╣        */
                    ___, ___, ___, ___, ___,        _F12, _F7, _F8, _F9, ___,
                    ___, ___, ___, ___, ___,        _F10, _F4, _F5, _F6, ___,
                    ___, ___, ___, ___, ___,        _F11, _F1, _F2, _F3, ___,

                                  FROM, ___,        ___, FROM

    ),


/*══════════════════════════════| • • • • • • • •  - MACRO:4 |══════════════════════════════════╣
                                                                                                ║
        ╔══════╦══════╦══════╦══════╦══════╗       ╔══════╦══════╦══════╦══════╦══════╗         ║
        ║      ║      ║      ║      ║      ║       ║      ║      ║      ║      ║      ║         ║
        ║      ║      ║      ║      ║      ║       ║      ║      ║      ║      ║      ║         ║
        ╠══════╬══════╬══════╬══════╬══════╣       ╠══════╬══════╬══════╬══════╬══════╣         ║
        ║      ║      ║      ║      ║      ║       ║      ║      ║      ║      ║      ║         ║
        ║      ║      ║  M2  ║  M1  ║      ║       ║      ║      ║      ║      ║      ║         ║
        ╠══════╬══════╬══════╬══════╬══════╣       ╠══════╬══════╬══════╬══════╬══════╣         ║
        ║      ║      ║      ║      ║      ║       ║      ║      ║      ║      ║      ║         ║
        ║      ║      ║  M2R ║  M1R ║      ║       ║      ║      ║      ║      ║      ║         ║
        ╚══════╩══════╩══════╩══════╩══════╝       ╚══════╩══════╩══════╩══════╩══════╝         ║
                               ╔═════╦═════╗       ╔═════╦═════╗                                ║
                               ║     ║     ║       ║     ║     ║                                ║
                               ║     ║     ║       ║     ║     ║                                ║
                               ╚═════╩═════╝       ╚═════╩═════╝                                ║
                                                                                                ║        */
    [_MACRO] = LAYOUT(/*     MACRO :4 ══════════════════════════════════════════════════════════╣        */
             ___,   ___,   ___,   ___,  ___,       ___, ___, ___, ___, ___,
             ___, ___, DM_PLY2, DM_PLY1, ___,      ___, ___, ___, ___, ___,
             ___, ___, DM_REC2, DM_REC1, ___,      ___, ___, ___, ___, ___,

                                   FROM, ___, ___, MEDIA

    ),


/*══════════════════════════════| • • • • • • • •  - MEDIA:5 |══════════════════════════════════╣
                                                                                                ║
        ╔══════╦══════╦══════╦══════╦══════╗       ╔══════╦══════╦══════╦══════╦══════╗         ║
        ║      ║      ║      ║      ║      ║       ║      ║      ║      ║      ║      ║         ║
        ║      ║      ║      ║      ║      ║       ║      ║      ║      ║      ║      ║         ║
        ╠══════╬══════╬══════╬══════╬══════╣       ╠══════╬══════╬══════╬══════╬══════╣         ║
        ║      ║      ║      ║      ║      ║       ║      ║      ║      ║      ║      ║         ║
        ║      ║      ║      ║      ║      ║       ║  >|| ║  <<  ║  V↑  ║  V↓  ║  >>  ║         ║
        ╠══════╬══════╬══════╬══════╬══════╣       ╠══════╬══════╬══════╬══════╬══════╣         ║
        ║      ║      ║      ║      ║      ║       ║      ║      ║      ║      ║      ║         ║
        ║      ║      ║      ║      ║      ║       ║      ║      ║      ║      ║      ║         ║
        ╚══════╩══════╩══════╩══════╩══════╝       ╚══════╩══════╩══════╩══════╩══════╝         ║
                               ╔═════╦═════╗       ╔═════╦═════╗                                ║
                               ║     ║     ║       ║     ║     ║                                ║
                               ║     ║     ║       ║     ║ FROM║                                ║
                               ╚═════╩═════╝       ╚═════╩═════╝                                ║
                                                                                                ║        */
    [_MEDIA] = LAYOUT(/*     MEDIA :5 ══════════════════════════════════════════════════════════╣        */
                     ___, ___, ___, ___, ___,      ___, ___, ___, ___, ___,
                     ___, ___, ___, ___, ___,      PLAY, PRV, VDN, VUP, NXT,
                     ___, ___, ___, ___, ___,      ___, ___, ___, ___, ___,

                                       ___, ___, ___, FROM

    ),


/*══════════════════════════════════════════════════════════════════════════════════════════════╣
                                                                                                ║
*═══════════════════════════════════════════════════════════════════════════════════════════════╣           */
};
/*                                     ,_    /) (\    _,                                        ║
                                        >>  <<,_,>>  <<                                         ║
                                       //   _0.-.0_   \\                                        ║
                                       \'._/       \_.'/                                        ║
                                        '-.\.--.--./.-'                                         ║
                                        __/ : :Y: : \__                                         ║
                                ';,  .-(_| : : | : : |_)-.  ,:'                                 ║
                                  \\/.'  |: : :|: : :|  `.\//                                   ║
                                   (/    |: : :|: : :|    \)                                    ║
                                         |: : :|: : :;                                          ║
                                        /\ : : | : : /\                                         ║
                                       (_/'.: :.: :.'\_)                                        ║
                                        \\  `""`""`  //                                         ║
                                         \\         //                                          ║
                                          ':.     .:'                                           ║
════════════════════════════════════════════════════════════════════════════════════════════════╣
                                                                                                ║
*═══════════════════════════════════════════════════════════════════════════════════════════════╝           */





